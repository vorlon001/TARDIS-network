{"payload":{"allShortcutsEnabled":false,"fileTree":{"docs":{"items":[{"name":"COPYING.docs","path":"docs/COPYING.docs","contentType":"file"},{"name":"amd_sev_snp.md","path":"docs/amd_sev_snp.md","contentType":"file"},{"name":"api.md","path":"docs/api.md","contentType":"file"},{"name":"balloon.md","path":"docs/balloon.md","contentType":"file"},{"name":"building.md","path":"docs/building.md","contentType":"file"},{"name":"coverage.md","path":"docs/coverage.md","contentType":"file"},{"name":"cpu.md","path":"docs/cpu.md","contentType":"file"},{"name":"custom-image.md","path":"docs/custom-image.md","contentType":"file"},{"name":"debug-port.md","path":"docs/debug-port.md","contentType":"file"},{"name":"device_model.md","path":"docs/device_model.md","contentType":"file"},{"name":"fs.md","path":"docs/fs.md","contentType":"file"},{"name":"fuzzing.md","path":"docs/fuzzing.md","contentType":"file"},{"name":"gdb.md","path":"docs/gdb.md","contentType":"file"},{"name":"heap-profiling.md","path":"docs/heap-profiling.md","contentType":"file"},{"name":"hotplug.md","path":"docs/hotplug.md","contentType":"file"},{"name":"intel_sgx.md","path":"docs/intel_sgx.md","contentType":"file"},{"name":"intel_tdx.md","path":"docs/intel_tdx.md","contentType":"file"},{"name":"io_throttling.md","path":"docs/io_throttling.md","contentType":"file"},{"name":"iommu.md","path":"docs/iommu.md","contentType":"file"},{"name":"live_migration.md","path":"docs/live_migration.md","contentType":"file"},{"name":"logging.md","path":"docs/logging.md","contentType":"file"},{"name":"macvtap-bridge.md","path":"docs/macvtap-bridge.md","contentType":"file"},{"name":"memory.md","path":"docs/memory.md","contentType":"file"},{"name":"mshv.md","path":"docs/mshv.md","contentType":"file"},{"name":"performance_metrics.md","path":"docs/performance_metrics.md","contentType":"file"},{"name":"profiling.md","path":"docs/profiling.md","contentType":"file"},{"name":"releases.md","path":"docs/releases.md","contentType":"file"},{"name":"seccomp.md","path":"docs/seccomp.md","contentType":"file"},{"name":"snapshot_restore.md","path":"docs/snapshot_restore.md","contentType":"file"},{"name":"tpm.md","path":"docs/tpm.md","contentType":"file"},{"name":"tracing.md","path":"docs/tracing.md","contentType":"file"},{"name":"uefi.md","path":"docs/uefi.md","contentType":"file"},{"name":"vdpa.md","path":"docs/vdpa.md","contentType":"file"},{"name":"vfio-user.md","path":"docs/vfio-user.md","contentType":"file"},{"name":"vfio.md","path":"docs/vfio.md","contentType":"file"},{"name":"vhost-user-blk-testing.md","path":"docs/vhost-user-blk-testing.md","contentType":"file"},{"name":"vhost-user-net-testing.md","path":"docs/vhost-user-net-testing.md","contentType":"file"},{"name":"virtiofs-root.md","path":"docs/virtiofs-root.md","contentType":"file"},{"name":"vsock.md","path":"docs/vsock.md","contentType":"file"},{"name":"windows.md","path":"docs/windows.md","contentType":"file"}],"totalCount":40},"":{"items":[{"name":".github","path":".github","contentType":"directory"},{"name":"api_client","path":"api_client","contentType":"directory"},{"name":"arch","path":"arch","contentType":"directory"},{"name":"block","path":"block","contentType":"directory"},{"name":"devices","path":"devices","contentType":"directory"},{"name":"docs","path":"docs","contentType":"directory"},{"name":"event_monitor","path":"event_monitor","contentType":"directory"},{"name":"fuzz","path":"fuzz","contentType":"directory"},{"name":"hypervisor","path":"hypervisor","contentType":"directory"},{"name":"net_gen","path":"net_gen","contentType":"directory"},{"name":"net_util","path":"net_util","contentType":"directory"},{"name":"option_parser","path":"option_parser","contentType":"directory"},{"name":"pci","path":"pci","contentType":"directory"},{"name":"performance-metrics","path":"performance-metrics","contentType":"directory"},{"name":"rate_limiter","path":"rate_limiter","contentType":"directory"},{"name":"resources","path":"resources","contentType":"directory"},{"name":"scripts","path":"scripts","contentType":"directory"},{"name":"serial_buffer","path":"serial_buffer","contentType":"directory"},{"name":"src","path":"src","contentType":"directory"},{"name":"test_data","path":"test_data","contentType":"directory"},{"name":"test_infra","path":"test_infra","contentType":"directory"},{"name":"tests","path":"tests","contentType":"directory"},{"name":"tpm","path":"tpm","contentType":"directory"},{"name":"tracer","path":"tracer","contentType":"directory"},{"name":"vhost_user_block","path":"vhost_user_block","contentType":"directory"},{"name":"vhost_user_net","path":"vhost_user_net","contentType":"directory"},{"name":"virtio-devices","path":"virtio-devices","contentType":"directory"},{"name":"vm-allocator","path":"vm-allocator","contentType":"directory"},{"name":"vm-device","path":"vm-device","contentType":"directory"},{"name":"vm-migration","path":"vm-migration","contentType":"directory"},{"name":"vm-virtio","path":"vm-virtio","contentType":"directory"},{"name":"vmm","path":"vmm","contentType":"directory"},{"name":".gitignore","path":".gitignore","contentType":"file"},{"name":".gitlint","path":".gitlint","contentType":"file"},{"name":".rustfmt.toml","path":".rustfmt.toml","contentType":"file"},{"name":".typos.toml","path":".typos.toml","contentType":"file"},{"name":"CODEOWNERS","path":"CODEOWNERS","contentType":"file"},{"name":"CODE_OF_CONDUCT.md","path":"CODE_OF_CONDUCT.md","contentType":"file"},{"name":"CONTRIBUTING.md","path":"CONTRIBUTING.md","contentType":"file"},{"name":"CREDITS.md","path":"CREDITS.md","contentType":"file"},{"name":"Cargo.lock","path":"Cargo.lock","contentType":"file"},{"name":"Cargo.toml","path":"Cargo.toml","contentType":"file"},{"name":"Jenkinsfile","path":"Jenkinsfile","contentType":"file"},{"name":"LICENSE-APACHE","path":"LICENSE-APACHE","contentType":"file"},{"name":"LICENSE-BSD-3-Clause","path":"LICENSE-BSD-3-Clause","contentType":"file"},{"name":"MAINTAINERS.md","path":"MAINTAINERS.md","contentType":"file"},{"name":"README.md","path":"README.md","contentType":"file"},{"name":"build.rs","path":"build.rs","contentType":"file"},{"name":"release-notes.md","path":"release-notes.md","contentType":"file"}],"totalCount":49}},"fileTreeProcessingTime":13.028127000000001,"foldersToFetch":[],"reducedMotionEnabled":null,"repo":{"id":184341774,"defaultBranch":"main","name":"cloud-hypervisor","ownerLogin":"cloud-hypervisor","currentUserCanPush":false,"isFork":false,"isEmpty":false,"createdAt":"2019-04-30T22:49:03.000Z","ownerAvatar":"https://avatars.githubusercontent.com/u/50487650?v=4","public":true,"private":false,"isOrgOwned":true},"symbolsExpanded":false,"treeExpanded":true,"refInfo":{"name":"main","listCacheKey":"v0:1700266483.0","canEdit":false,"refType":"branch","currentOid":"4b87964093dc13b9db043a1c70040ff7d658137d"},"path":"docs/cpu.md","currentUser":null,"blob":{"rawLines":null,"stylingDirectives":null,"csv":null,"csvError":null,"dependabotInfo":{"showConfigurationBanner":false,"configFilePath":null,"networkDependabotPath":"/cloud-hypervisor/cloud-hypervisor/network/updates","dismissConfigurationNoticePath":"/settings/dismiss-notice/dependabot_configuration_notice","configurationNoticeDismissed":null,"repoAlertsPath":"/cloud-hypervisor/cloud-hypervisor/security/dependabot","repoSecurityAndAnalysisPath":"/cloud-hypervisor/cloud-hypervisor/settings/security_analysis","repoOwnerIsOrg":true,"currentUserCanAdminRepo":false},"displayName":"cpu.md","displayUrl":"https://github.com/cloud-hypervisor/cloud-hypervisor/blob/main/docs/cpu.md?raw=true","headerInfo":{"blobSize":"5.84 KB","deleteInfo":{"deleteTooltip":"You must be signed in to make or propose changes"},"editInfo":{"editTooltip":"You must be signed in to make or propose changes"},"ghDesktopPath":"https://desktop.github.com","gitLfsPath":null,"onBranch":true,"shortPath":"5dd7973","siteNavLoginPath":"/login?return_to=https%3A%2F%2Fgithub.com%2Fcloud-hypervisor%2Fcloud-hypervisor%2Fblob%2Fmain%2Fdocs%2Fcpu.md","isCSV":false,"isRichtext":true,"toc":[{"level":1,"text":"CPU","anchor":"cpu","htmlText":"CPU"},{"level":2,"text":"Options","anchor":"options","htmlText":"Options"},{"level":3,"text":"boot","anchor":"boot","htmlText":"boot"},{"level":3,"text":"max","anchor":"max","htmlText":"max"},{"level":3,"text":"topology","anchor":"topology","htmlText":"topology"},{"level":3,"text":"kvm_hyperv","anchor":"kvm_hyperv","htmlText":"kvm_hyperv"},{"level":3,"text":"max_phys_bits","anchor":"max_phys_bits","htmlText":"max_phys_bits"},{"level":3,"text":"affinity","anchor":"affinity","htmlText":"affinity"},{"level":3,"text":"features","anchor":"features","htmlText":"features"}],"lineInfo":{"truncatedLoc":"211","truncatedSloc":"147"},"mode":"file"},"image":false,"isCodeownersFile":null,"isPlain":false,"isValidLegacyIssueTemplate":false,"issueTemplateHelpUrl":"https://docs.github.com/articles/about-issue-and-pull-request-templates","issueTemplate":null,"discussionTemplate":null,"language":"Markdown","languageID":222,"large":false,"loggedIn":false,"newDiscussionPath":"/cloud-hypervisor/cloud-hypervisor/discussions/new","newIssuePath":"/cloud-hypervisor/cloud-hypervisor/issues/new","planSupportInfo":{"repoIsFork":null,"repoOwnedByCurrentUser":null,"requestFullPath":"/cloud-hypervisor/cloud-hypervisor/blob/main/docs/cpu.md","showFreeOrgGatedFeatureMessage":null,"showPlanSupportBanner":null,"upgradeDataAttributes":null,"upgradePath":null},"publishBannersInfo":{"dismissActionNoticePath":"/settings/dismiss-notice/publish_action_from_dockerfile","dismissStackNoticePath":"/settings/dismiss-notice/publish_stack_from_file","releasePath":"/cloud-hypervisor/cloud-hypervisor/releases/new?marketplace=true","showPublishActionBanner":false,"showPublishStackBanner":false},"rawBlobUrl":"https://github.com/cloud-hypervisor/cloud-hypervisor/raw/main/docs/cpu.md","renderImageOrRaw":false,"richText":"<article class=\"markdown-body entry-content container-lg\" itemprop=\"text\"><h1 tabindex=\"-1\" dir=\"auto\"><a id=\"user-content-cpu\" class=\"anchor\" aria-hidden=\"true\" tabindex=\"-1\" href=\"#cpu\"><svg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a>CPU</h1>\n<p dir=\"auto\">Cloud Hypervisor has many options when it comes to the creation of virtual\nCPUs. This document aims to explain what Cloud Hypervisor is capable of and\nhow it can be used to meet the needs of very different use cases.</p>\n<h2 tabindex=\"-1\" dir=\"auto\"><a id=\"user-content-options\" class=\"anchor\" aria-hidden=\"true\" tabindex=\"-1\" href=\"#options\"><svg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a>Options</h2>\n<p dir=\"auto\"><code>CpusConfig</code> or what is known as <code>--cpus</code> from the CLI perspective is the way\nto set vCPUs options for Cloud Hypervisor.</p>\n<div class=\"highlight highlight-source-rust notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"struct CpusConfig {\n    boot_vcpus: u8,\n    max_vcpus: u8,\n    topology: Option&lt;CpuTopology&gt;,\n    kvm_hyperv: bool,\n    max_phys_bits: u8,\n    affinity: Option&lt;Vec&lt;CpuAffinity&gt;&gt;,\n    features: CpuFeatures,\n}\"><pre><span class=\"pl-k\">struct</span> <span class=\"pl-smi\">CpusConfig</span> <span class=\"pl-kos\">{</span>\n    <span class=\"pl-c1\">boot_vcpus</span><span class=\"pl-kos\">:</span> <span class=\"pl-smi\">u8</span><span class=\"pl-kos\">,</span>\n    <span class=\"pl-c1\">max_vcpus</span><span class=\"pl-kos\">:</span> <span class=\"pl-smi\">u8</span><span class=\"pl-kos\">,</span>\n    <span class=\"pl-c1\">topology</span><span class=\"pl-kos\">:</span> <span class=\"pl-smi\">Option</span><span class=\"pl-kos\">&lt;</span><span class=\"pl-smi\">CpuTopology</span><span class=\"pl-kos\">&gt;</span><span class=\"pl-kos\">,</span>\n    <span class=\"pl-c1\">kvm_hyperv</span><span class=\"pl-kos\">:</span> <span class=\"pl-smi\">bool</span><span class=\"pl-kos\">,</span>\n    <span class=\"pl-c1\">max_phys_bits</span><span class=\"pl-kos\">:</span> <span class=\"pl-smi\">u8</span><span class=\"pl-kos\">,</span>\n    <span class=\"pl-c1\">affinity</span><span class=\"pl-kos\">:</span> <span class=\"pl-smi\">Option</span><span class=\"pl-kos\">&lt;</span><span class=\"pl-smi\">Vec</span><span class=\"pl-kos\">&lt;</span><span class=\"pl-smi\">CpuAffinity</span><span class=\"pl-kos\">&gt;</span><span class=\"pl-kos\">&gt;</span><span class=\"pl-kos\">,</span>\n    <span class=\"pl-c1\">features</span><span class=\"pl-kos\">:</span> <span class=\"pl-smi\">CpuFeatures</span><span class=\"pl-kos\">,</span>\n<span class=\"pl-kos\">}</span></pre></div>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"--cpus boot=&lt;boot_vcpus&gt;,max=&lt;max_vcpus&gt;,topology=&lt;threads_per_core&gt;:&lt;cores_per_die&gt;:&lt;dies_per_package&gt;:&lt;packages&gt;,kvm_hyperv=on|off,max_phys_bits=&lt;maximum_number_of_physical_bits&gt;,affinity=&lt;list_of_vcpus_with_their_associated_cpuset&gt;,features=&lt;list_of_features_to_enable&gt;\"><pre class=\"notranslate\"><code>--cpus boot=&lt;boot_vcpus&gt;,max=&lt;max_vcpus&gt;,topology=&lt;threads_per_core&gt;:&lt;cores_per_die&gt;:&lt;dies_per_package&gt;:&lt;packages&gt;,kvm_hyperv=on|off,max_phys_bits=&lt;maximum_number_of_physical_bits&gt;,affinity=&lt;list_of_vcpus_with_their_associated_cpuset&gt;,features=&lt;list_of_features_to_enable&gt;\n</code></pre></div>\n<h3 tabindex=\"-1\" dir=\"auto\"><a id=\"user-content-boot\" class=\"anchor\" aria-hidden=\"true\" tabindex=\"-1\" href=\"#boot\"><svg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a><code>boot</code></h3>\n<p dir=\"auto\">Number of vCPUs present at boot time.</p>\n<p dir=\"auto\">This option allows to define a specific number of vCPUs to be present at the\ntime the VM is started. This option is mandatory when using the <code>--cpus</code>\nparameter. If <code>--cpus</code> is not specified, this option takes the default value\nof <code>1</code>, starting the VM with a single vCPU.</p>\n<p dir=\"auto\">Value is an unsigned integer of 8 bits.</p>\n<p dir=\"auto\"><em>Example</em></p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"--cpus boot=2\"><pre class=\"notranslate\"><code>--cpus boot=2\n</code></pre></div>\n<h3 tabindex=\"-1\" dir=\"auto\"><a id=\"user-content-max\" class=\"anchor\" aria-hidden=\"true\" tabindex=\"-1\" href=\"#max\"><svg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a><code>max</code></h3>\n<p dir=\"auto\">Maximum number of vCPUs.</p>\n<p dir=\"auto\">This option defines the maximum number of vCPUs that can be assigned to the VM.\nIn particular, this option is used when looking for CPU hotplug as it lets the\nprovide an indication about how many vCPUs might be needed later during the\nruntime of the VM.\nFor instance, if booting the VM with 2 vCPUs and a maximum of 6 vCPUs, it means\nup to 4 vCPUs can be added later at runtime by resizing the VM.</p>\n<p dir=\"auto\">The value must be greater than or equal to the number of boot vCPUs.\nThe value is an unsigned integer of 8 bits.</p>\n<p dir=\"auto\">By default this option takes the value of <code>boot</code>, meaning vCPU hotplug is not\nexpected and can't be performed.</p>\n<p dir=\"auto\"><em>Example</em></p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"--cpus max=3\"><pre class=\"notranslate\"><code>--cpus max=3\n</code></pre></div>\n<h3 tabindex=\"-1\" dir=\"auto\"><a id=\"user-content-topology\" class=\"anchor\" aria-hidden=\"true\" tabindex=\"-1\" href=\"#topology\"><svg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a><code>topology</code></h3>\n<p dir=\"auto\">Topology of the guest platform.</p>\n<p dir=\"auto\">This option gives the user a way to describe the exact topology that should be\nexposed to the guest. It can be useful to describe to the guest the same\ntopology found on the host as it allows for proper usage of the resources and\nis a way to achieve better performances.</p>\n<p dir=\"auto\">The topology is described through the following structure:</p>\n<div class=\"highlight highlight-source-rust notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"struct CpuTopology {\n    threads_per_core: u8,\n    cores_per_die: u8,\n    dies_per_package: u8,\n    packages: u8,\n}\"><pre><span class=\"pl-k\">struct</span> <span class=\"pl-smi\">CpuTopology</span> <span class=\"pl-kos\">{</span>\n    <span class=\"pl-c1\">threads_per_core</span><span class=\"pl-kos\">:</span> <span class=\"pl-smi\">u8</span><span class=\"pl-kos\">,</span>\n    <span class=\"pl-c1\">cores_per_die</span><span class=\"pl-kos\">:</span> <span class=\"pl-smi\">u8</span><span class=\"pl-kos\">,</span>\n    <span class=\"pl-c1\">dies_per_package</span><span class=\"pl-kos\">:</span> <span class=\"pl-smi\">u8</span><span class=\"pl-kos\">,</span>\n    <span class=\"pl-c1\">packages</span><span class=\"pl-kos\">:</span> <span class=\"pl-smi\">u8</span><span class=\"pl-kos\">,</span>\n<span class=\"pl-kos\">}</span></pre></div>\n<p dir=\"auto\">or the following syntax through the CLI:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"topology=&lt;threads_per_core&gt;:&lt;cores_per_die&gt;:&lt;dies_per_package&gt;:&lt;packages&gt;\"><pre class=\"notranslate\"><code>topology=&lt;threads_per_core&gt;:&lt;cores_per_die&gt;:&lt;dies_per_package&gt;:&lt;packages&gt;\n</code></pre></div>\n<p dir=\"auto\">By default the topology will be <code>1:1:1:1</code>.</p>\n<p dir=\"auto\"><em>Example</em></p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"--cpus boot=2,topology=1:1:2:1\"><pre class=\"notranslate\"><code>--cpus boot=2,topology=1:1:2:1\n</code></pre></div>\n<h3 tabindex=\"-1\" dir=\"auto\"><a id=\"user-content-kvm_hyperv\" class=\"anchor\" aria-hidden=\"true\" tabindex=\"-1\" href=\"#kvm_hyperv\"><svg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a><code>kvm_hyperv</code></h3>\n<p dir=\"auto\">Enable KVM Hyper-V emulation.</p>\n<p dir=\"auto\">When turned on, this option relies on KVM to emulate the synthetic interrupt\ncontroller (SynIC) along with synthetic timers expected by a Windows guest.\nA Windows guest usually runs on top of Microsoft Hyper-V, therefore expects\nthese synthetic devices to be present. That's why KVM provides a way to emulate\nthem and avoids failures running a Windows guest with Cloud Hypervisor.</p>\n<p dir=\"auto\">By default this option is turned off.</p>\n<p dir=\"auto\"><em>Example</em></p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"--cpus kvm_hyperv=on\"><pre class=\"notranslate\"><code>--cpus kvm_hyperv=on\n</code></pre></div>\n<h3 tabindex=\"-1\" dir=\"auto\"><a id=\"user-content-max_phys_bits\" class=\"anchor\" aria-hidden=\"true\" tabindex=\"-1\" href=\"#max_phys_bits\"><svg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a><code>max_phys_bits</code></h3>\n<p dir=\"auto\">Maximum size for guest's addressable space.</p>\n<p dir=\"auto\">This option defines the maximum number of physical bits for all vCPUs, which\nsets a limit for the size of the guest's addressable space. This is mainly\nuseful for debug purpose.</p>\n<p dir=\"auto\">The value is an unsigned integer of 8 bits.</p>\n<p dir=\"auto\"><em>Example</em></p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"--cpus max_phys_bits=40\"><pre class=\"notranslate\"><code>--cpus max_phys_bits=40\n</code></pre></div>\n<h3 tabindex=\"-1\" dir=\"auto\"><a id=\"user-content-affinity\" class=\"anchor\" aria-hidden=\"true\" tabindex=\"-1\" href=\"#affinity\"><svg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a><code>affinity</code></h3>\n<p dir=\"auto\">Affinity of each vCPU.</p>\n<p dir=\"auto\">This option gives the user a way to provide the host CPU set associated with\neach vCPU. It is useful for achieving CPU pinning, ensuring multiple VMs won't\naffect the performance of each other. It might also be used in the context of\nNUMA as it is way of making sure the VM can run on a specific host NUMA node.\nIn general, this option is used to increase the performances of a VM depending\non the host platform and the type of workload running in the guest.</p>\n<p dir=\"auto\">The affinity is described through the following structure:</p>\n<div class=\"highlight highlight-source-rust notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"struct CpuAffinity {\n    vcpu: u8,\n    host_cpus: Vec&lt;u8&gt;,\n}\"><pre><span class=\"pl-k\">struct</span> <span class=\"pl-smi\">CpuAffinity</span> <span class=\"pl-kos\">{</span>\n    <span class=\"pl-c1\">vcpu</span><span class=\"pl-kos\">:</span> <span class=\"pl-smi\">u8</span><span class=\"pl-kos\">,</span>\n    <span class=\"pl-c1\">host_cpus</span><span class=\"pl-kos\">:</span> <span class=\"pl-smi\">Vec</span><span class=\"pl-kos\">&lt;</span><span class=\"pl-smi\">u8</span><span class=\"pl-kos\">&gt;</span><span class=\"pl-kos\">,</span>\n<span class=\"pl-kos\">}</span></pre></div>\n<p dir=\"auto\">or the following syntax through the CLI:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"affinity=[&lt;vcpu_id1&gt;@[&lt;host_cpu_id1&gt;, &lt;host_cpu_id2&gt;], &lt;vcpu_id2&gt;@[&lt;host_cpu_id3&gt;, &lt;host_cpu_id4&gt;]]\"><pre class=\"notranslate\"><code>affinity=[&lt;vcpu_id1&gt;@[&lt;host_cpu_id1&gt;, &lt;host_cpu_id2&gt;], &lt;vcpu_id2&gt;@[&lt;host_cpu_id3&gt;, &lt;host_cpu_id4&gt;]]\n</code></pre></div>\n<p dir=\"auto\">The outer brackets define the list of vCPUs. And for each vCPU, the inner\nbrackets attached to <code>@</code> define the list of host CPUs the vCPU is allowed to\nrun onto.</p>\n<p dir=\"auto\">Multiple values can be provided to define each list. Each value is an unsigned\ninteger of 8 bits.</p>\n<p dir=\"auto\">For instance, if one needs to run vCPU 0 on host CPUs from 0 to 4, the syntax\nusing <code>-</code> will help define a contiguous range with <code>affinity=0@[0-4]</code>. The\nsame example could also be described with <code>affinity=0@[0,1,2,3,4]</code>.</p>\n<p dir=\"auto\">A combination of both <code>-</code> and <code>,</code> separators is useful when one might need to\ndescribe a list containing host CPUs from 0 to 99 and the host CPU 255, as it\ncould simply be described with <code>affinity=0@[0-99,255]</code>.</p>\n<p dir=\"auto\">As soon as one tries to describe a list of values, <code>[</code> and <code>]</code> must be used to\ndemarcate the list.</p>\n<p dir=\"auto\">By default each vCPU runs on the entire host CPU set.</p>\n<p dir=\"auto\"><em>Example</em></p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"--cpus boot=3,affinity=[0@[2,3],1@[0,1]]\"><pre class=\"notranslate\"><code>--cpus boot=3,affinity=[0@[2,3],1@[0,1]]\n</code></pre></div>\n<p dir=\"auto\">In this example, assuming the host has 4 CPUs, vCPU 0 will run exclusively on\nhost CPUs 2 and 3, while vCPU 1 will run exclusively on host CPUs 0 and 1.\nBecause nothing is defined for vCPU 2, it can run on any of the 4 host CPUs.</p>\n<h3 tabindex=\"-1\" dir=\"auto\"><a id=\"user-content-features\" class=\"anchor\" aria-hidden=\"true\" tabindex=\"-1\" href=\"#features\"><svg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"><path d=\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\"></path></svg></a><code>features</code></h3>\n<p dir=\"auto\">Set of CPU features to enable.</p>\n<p dir=\"auto\">This option allows the user to enable a set of CPU features that are disabled\nby default otherwise.</p>\n<p dir=\"auto\">The currently available feature set is: <code>amx</code>.</p>\n<p dir=\"auto\">The <code>amx</code> feature will enable the x86 extension adding hardware units for\nmatrix operations (int and float dot products). The goal of the extension is to\nprovide performance enhancements for these common operations.</p>\n<p dir=\"auto\"><em>Example</em></p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"--cpus features=amx\"><pre class=\"notranslate\"><code>--cpus features=amx\n</code></pre></div>\n<p dir=\"auto\">In this example the amx CPU feature will be enabled for the VMM.</p>\n</article>","renderedFileInfo":null,"shortPath":null,"tabSize":8,"topBannersInfo":{"overridingGlobalFundingFile":false,"globalPreferredFundingPath":null,"repoOwner":"cloud-hypervisor","repoName":"cloud-hypervisor","showInvalidCitationWarning":false,"citationHelpUrl":"https://docs.github.com/en/github/creating-cloning-and-archiving-repositories/creating-a-repository-on-github/about-citation-files","showDependabotConfigurationBanner":false,"actionsOnboardingTip":null},"truncated":false,"viewable":true,"workflowRedirectUrl":null,"symbols":{"timedOut":false,"notAnalyzed":false,"symbols":[{"name":"CPU","kind":"section_1","identStart":2,"identEnd":5,"extentStart":0,"extentEnd":5977,"fullyQualifiedName":"CPU","identUtf16":{"start":{"lineNumber":0,"utf16Col":2},"end":{"lineNumber":0,"utf16Col":5}},"extentUtf16":{"start":{"lineNumber":0,"utf16Col":0},"end":{"lineNumber":211,"utf16Col":0}}},{"name":"Options","kind":"section_2","identStart":228,"identEnd":235,"extentStart":225,"extentEnd":5977,"fullyQualifiedName":"Options","identUtf16":{"start":{"lineNumber":6,"utf16Col":3},"end":{"lineNumber":6,"utf16Col":10}},"extentUtf16":{"start":{"lineNumber":6,"utf16Col":0},"end":{"lineNumber":211,"utf16Col":0}}},{"name":"`boot`","kind":"section_3","identStart":866,"identEnd":872,"extentStart":862,"extentEnd":1260,"fullyQualifiedName":"`boot`","identUtf16":{"start":{"lineNumber":27,"utf16Col":4},"end":{"lineNumber":27,"utf16Col":10}},"extentUtf16":{"start":{"lineNumber":27,"utf16Col":0},"end":{"lineNumber":44,"utf16Col":0}}},{"name":"`max`","kind":"section_3","identStart":1264,"identEnd":1269,"extentStart":1260,"extentEnd":1955,"fullyQualifiedName":"`max`","identUtf16":{"start":{"lineNumber":44,"utf16Col":4},"end":{"lineNumber":44,"utf16Col":9}},"extentUtf16":{"start":{"lineNumber":44,"utf16Col":0},"end":{"lineNumber":67,"utf16Col":0}}},{"name":"`topology`","kind":"section_3","identStart":1959,"identEnd":1969,"extentStart":1955,"extentEnd":2685,"fullyQualifiedName":"`topology`","identUtf16":{"start":{"lineNumber":67,"utf16Col":4},"end":{"lineNumber":67,"utf16Col":14}},"extentUtf16":{"start":{"lineNumber":67,"utf16Col":0},"end":{"lineNumber":101,"utf16Col":0}}},{"name":"`kvm_hyperv`","kind":"section_3","identStart":2689,"identEnd":2701,"extentStart":2685,"extentEnd":3196,"fullyQualifiedName":"`kvm_hyperv`","identUtf16":{"start":{"lineNumber":101,"utf16Col":4},"end":{"lineNumber":101,"utf16Col":16}},"extentUtf16":{"start":{"lineNumber":101,"utf16Col":0},"end":{"lineNumber":119,"utf16Col":0}}},{"name":"`max_phys_bits`","kind":"section_3","identStart":3200,"identEnd":3215,"extentStart":3196,"extentEnd":3530,"fullyQualifiedName":"`max_phys_bits`","identUtf16":{"start":{"lineNumber":119,"utf16Col":4},"end":{"lineNumber":119,"utf16Col":19}},"extentUtf16":{"start":{"lineNumber":119,"utf16Col":0},"end":{"lineNumber":135,"utf16Col":0}}},{"name":"`affinity`","kind":"section_3","identStart":3534,"identEnd":3544,"extentStart":3530,"extentEnd":5458,"fullyQualifiedName":"`affinity`","identUtf16":{"start":{"lineNumber":135,"utf16Col":4},"end":{"lineNumber":135,"utf16Col":14}},"extentUtf16":{"start":{"lineNumber":135,"utf16Col":0},"end":{"lineNumber":191,"utf16Col":0}}},{"name":"`features`","kind":"section_3","identStart":5462,"identEnd":5472,"extentStart":5458,"extentEnd":5977,"fullyQualifiedName":"`features`","identUtf16":{"start":{"lineNumber":191,"utf16Col":4},"end":{"lineNumber":191,"utf16Col":14}},"extentUtf16":{"start":{"lineNumber":191,"utf16Col":0},"end":{"lineNumber":211,"utf16Col":0}}}]}},"copilotInfo":null,"copilotAccessAllowed":false,"csrf_tokens":{"/cloud-hypervisor/cloud-hypervisor/branches":{"post":"hluIjAKO7v8oknKIJxzQogaqw7WRYZWG2jJmP-KmeTZhzK6G77iBilepeKxSHwqr6jJGzLx9jFf8nJEvqLJPPw"},"/repos/preferences":{"post":"5aBtNkoGZ0SuQ_IFWbCx-xCem91_ZZWVOAMIs6T-7tvpEwtMozRqueJq0sVzkVW4QwwaaCGtRP9zzNc99xe-vw"}}},"title":"cloud-hypervisor/docs/cpu.md at main Â· cloud-hypervisor/cloud-hypervisor"}